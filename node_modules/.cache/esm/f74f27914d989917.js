_4d9‍.x([["Settings",()=>Settings]]);class Settings {
    constructor(client, settings) {
        this.client = client;
        this.settings = settings.settings;
        this.channelId = settings.serverId.general.settings.channel
        this.roleId = settings.serverId.general.settings.roles.GeneralAnnouncements

        this.setupSettings();

        this.waitForReactions();
        this.waitForReactionRemove();
    }

    setupSettings() {
        const channel = this.client.channels.cache.get(this.channelId);

        channel.messages.fetch({limit: 1})
            .then(messages => {
                let message;
                if (messages.size === 0) {
                    message = channel.send(this.settings.announcementMessage)
                } else {
                    message = messages.first();
                }
                message.react('✅');
            })
            .catch(error => {
                console.error(error);
            });
    }

    waitForReactions() {
        this.client.on('messageReactionAdd', (reaction, user) => {
            if (user && !user.bot && reaction.message.channel.id === this.channelId) {
                reaction.message.guild.roles.fetch(this.roleId)
                    .then(role => {
                        reaction.message.guild.member(user).roles.add(role);
                    });
            }
        });
    }

    waitForReactionRemove() {
        this.client.on('messageReactionRemove', (reaction, user) => {
            if (user && !user.bot && reaction.message.channel.id === this.channelId) {
                reaction.message.guild.roles.fetch(this.roleId)
                    .then(role => {
                        reaction.message.guild.member(user).roles.remove(role);
                    });
            }
        });
    }

}
